# -*- mode: ruby -*-
# vi: set ft=ruby :

Vagrant.configure("2") do |config|

  # this is needed if you wish to have access
  # to the varibales defined in CUSTOME_VARIABLES.
  # It will convert the formatted string into a 
  # proper ruby hash. Afterwards you can access every variable
  # using the "hash" variable e.g. hash["KEY"]

  hash_string = ENV["CUSTOME_VARIABLES_STRING"]
  hash_arr = hash_string.split(",")
  hash = {}

  hash_arr.each do |e|
    pair = e.split(":")
    key = pair[0]
    value = pair[1]
    hash[key] = value
  end

  config.vm.box = ENV["OS_IMAGE"] 
  config.vm.provision "shell", path: ENV["SCRIPT"], env: hash
  config.vm.synced_folder ENV["SYNC_DIR"], "/home/#{ENV['SYNC_USER']}/sync_dir", disabled:false
  config.vm.synced_folder ".", "/vagrant", disabled:true
  config.vm.network "private_network", ip: "192.168.56.8"

  config.vm.provider "virtualbox" do |vb|
    vb.name = ENV["VM_NAME"]
    vb.memory = ENV["RAM"]
    vb.cpus = ENV["CPU"]
  end
  
end
